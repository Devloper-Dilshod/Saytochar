<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Redirecting…</title>
  <style>
    :root{color-scheme:dark}
    body{
      font-family:system-ui,Segoe UI,Roboto,Arial;
      display:flex;align-items:center;justify-content:center;
      height:100vh;margin:0;background:#0b1220;color:#e6eef8
    }
    .card{
      background:rgba(255,255,255,0.05);
      padding:24px;border-radius:14px;
      text-align:center;max-width:400px;
      box-shadow:0 8px 30px rgba(0,0,0,.4)
    }
    button{
      margin-top:14px;padding:10px 18px;
      border:0;border-radius:8px;cursor:pointer;
      font-size:15px;background:#2563eb;color:#fff
    }
    small{display:block;margin-top:10px;opacity:.8}
  </style>
</head>
<body>
  <div class="card" id="box">
    <h2 id="status">Yo'naltirilmoqda…</h2>
    <p id="desc">Agar avtomatik o‘tish bo‘lmasa, tugmani bosing.</p>
    <button id="openBtn">Open in Telegram</button>
    <small id="info"></small>
  </div>

  <script>
    // === 1. URL dan username ni olish ===
    const path = window.location.pathname.replace(/^\/+|\/+$/g, '');
    const username = path || 'home'; // agar bo'sh bo'lsa, fallback
    const tgUrl = 'https://t.me/' + encodeURIComponent(username);
    document.getElementById('info').textContent = '@' + username;

    // === 2. Oddiy bot tekshiruvi ===
    const isBot = (() => {
      const ua = (navigator.userAgent || '').toLowerCase();
      return (
        navigator.webdriver ||
        /bot|crawl|spider|slurp|curl|wget|python|httpclient|java/.test(ua)
      );
    })();

    // === 3. Foydalanuvchini yo'naltirish yoki tugma orqali o'tkazish ===
    const btn = document.getElementById('openBtn');
    btn.onclick = () => (window.location.href = tgUrl);

    if (!isBot) {
      // avtomatik o‘tkazish
      setTimeout(() => {
        try {
          window.location.replace(tgUrl);
        } catch {
          window.location.href = tgUrl;
        }
      }, 300); // 0.3 soniyada
    } else {
      // bot uchun faqat qo‘lda ochish
      document.getElementById('status').textContent = 'Avtomatik o‘tish o‘chirildi';
      document.getElementById('desc').textContent =
        'Iltimos, Telegram sahifasini ochish uchun tugmani bosing.';
    }
  </script>
</body>
</html>
